"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProofOfDocumentService = void 0;
const __1 = require("..");
const jsonld = require('jsonld');
const nacl = require('tweetnacl');
class ProofOfDocumentService {
    static generateProof(document, key, creator) {
        const keypair = nacl.sign.keyPair.fromSecretKey(key.privateKey64);
        const didBuffer = Buffer.from(JSON.stringify(document));
        const sign = nacl.sign.detached(didBuffer, keypair.secretKey);
        document.proof = {
            type: "Ed25519Signature2018",
            created: new Date().toISOString(),
            creator: creator,
            signatureValue: __1.SecurityService.sha256StringHash(JSON.stringify(sign))
        };
        return document;
    }
}
exports.ProofOfDocumentService = ProofOfDocumentService;
