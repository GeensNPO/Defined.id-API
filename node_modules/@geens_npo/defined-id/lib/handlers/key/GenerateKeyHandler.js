"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.GenerateKeyHandler = void 0;
const __1 = require("../..");
const BaseHandler_1 = require("../BaseHandler");
class GenerateKeyHandler extends BaseHandler_1.BaseHandler {
    handleCore(request) {
        const key = new __1.Key(
        // @ts-ignore
        __1.Purposes.find(request.keyId), request.seed, request.personaId, request.connectionId);
        return {
            key: key
        };
    }
    validateCore(request) {
        const errors = [];
        if (!request.seed)
            errors.push('Seed is required');
        if (!request.personaId && request.personaId !== 0)
            errors.push('Persona id is required');
        else if (!__1.KeyValidator.isNaturalNumber(request.personaId))
            errors.push('Persona id is invalid');
        if (!request.connectionId)
            errors.push('Connection id is required');
        if (request.connectionId && !__1.KeyValidator.isNaturalNumber(request.connectionId))
            errors.push('Connection id is invalid');
        if (!request.keyId)
            errors.push('Key id is required');
        else
            __1.Purposes.find(request.keyId) === undefined ? errors.push(`Key id : {${request.keyId}} is invalid`) : '';
        return errors;
    }
}
exports.GenerateKeyHandler = GenerateKeyHandler;
